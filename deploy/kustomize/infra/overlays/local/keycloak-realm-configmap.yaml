# Where: deploy/kustomize/infra/overlays/local/keycloak-realm-configmap.yaml
# What: Local Keycloak bootstrap realm/client/user definition.
# Why: Eliminate manual console setup for routine local OIDC verification.
apiVersion: v1
kind: ConfigMap
metadata:
  name: keycloak-realm-bootstrap
  namespace: miniserversystem
data:
  miniserversystem-realm.json: |
    {
      "realm": "miniserversystem",
      "enabled": true,
      "clients": [
        {
          "clientId": "gateway-bff",
          "name": "gateway-bff",
          "enabled": true,
          "protocol": "openid-connect",
          "publicClient": false,
          "secret": "fovHK8ZOOKXRpyMYYeShF0QQpIQbiIZe",
          "redirectUris": [
            "http://localhost/login/oauth2/code/keycloak",
            "http://localhost:18080/login/oauth2/code/keycloak",
            "http://127.0.0.1:18080/login/oauth2/code/keycloak"
          ],
          "webOrigins": [
            "http://localhost",
            "http://localhost:18080",
            "http://127.0.0.1:18080"
          ],
          "standardFlowEnabled": true,
          "directAccessGrantsEnabled": true
        }
      ],
      "users": [
        {
          "username": "test",
          "enabled": true,
          "emailVerified": true,
          "firstName": "E2E",
          "lastName": "User",
          "email": "test@example.com",
          "credentials": [
            {
              "type": "password",
              "value": "test",
              "temporary": false
            }
          ]
        },
        {
          "username": "test2",
          "enabled": true,
          "emailVerified": true,
          "firstName": "E2E",
          "lastName": "User2",
          "email": "test2@example.com",
          "credentials": [
            {
              "type": "password",
              "value": "test",
              "temporary": false
            }
          ]
        }
      ]
    }
